<!DOCTYPE html>
<html lang="en">

<head>
  <title>Vanilla primes</title>
</head>

<body>
  <h1>vanilla primes</h1>
  <p>Simple vanilla JavaScript application that finds first N prime numbers</p>

  <div>
    <button id="find">Find</button> <input id="n" value="100" /> primes.
    <table>
      <thead>
        <th>index</th><th>prime</th>
      </thead>
      <tbody id="results">
      </tbody>
    </table>
  </div>

  <script>
    var primesApp = (function primesApp() {

      var worker = new Worker('worker.js');

      function primeToRow(p, k) {
        return '<tr><td>' + (k + 1) + '</td><td>' + p + '</td></tr>';
      }

      function renderPrimes(primes) {
        var html = primes.map(primeToRow).join('\n');
        document.querySelector('#results').innerHTML = html;
      }

      worker.onmessage = function (e) {
        console.log('worker has finished');
        renderPrimes(e.data);
      };

      return {
        findFirstPrimes: function () {
          var n = Number(document.querySelector('#n').value);
          console.log('finding first', n, 'primes');
          worker.postMessage({ cmd: 'primes', n: n });
        }
      };

    }());

    document.addEventListener('DOMContentLoaded', function() {
      document.querySelector('#find').addEventListener('click', function () {
        primesApp.findFirstPrimes();
      });
    });

  </script>
</body>
</html>
