<!DOCTYPE html>
<html lang="en">

<head>
  <title>Vanilla primes</title>
</head>

<body>
  <h1>vanilla primes</h1>
  <p>Simple vanilla JavaScript application that finds first N prime numbers</p>

  <div>
    <button id="find">Find</button> <input id="n" value="100" /> primes.
    <table>
      <thead>
        <th>index</th><th>prime</th>
      </thead>
      <tbody id="results">
      </tbody>
    </table>
  </div>

  <script>
    var primesApp = (function primesApp() {

      function isPrime(n) {
        try {
          var k;
          for (k = 2; k < n; k += 1) {
            if (n % k === 0) {
              return false;
            }
          }
        } catch (err) {
          console.error(err);
        }
        return true;
      }

      // finds Nth prime
      function findPrime(n) {
        var k = 1;
        var foundPrimes = [];
        while (foundPrimes.length < n) {
          if (isPrime(k)) {
            foundPrimes.push(k);
          }
          k += 1;
        };
        return foundPrimes[foundPrimes.length - 1];
      }

      function findFirstPrimes(n) {
        var primes = [], k, prime;
        for (k = 0; k < n; k += 1) {
          prime = findPrime(k + 1);
          primes.push(prime);
        }
        return primes;
      }

      function primeToRow(x, k) {
        return '<tr><td>' + (k + 1) + '</td><td>' + x + '</td></tr>';
      }

      function renderPrimes(primes) {
        var html = primes.map(primeToRow).join('\n');
        document.querySelector('#results').innerHTML = html;
      }

      return {
        findFirstPrimes: function () {
          var n = Number(document.querySelector('#n').value);
          console.log('finding first', n, 'primes');
          var primes = findFirstPrimes(n);
          renderPrimes(primes);
        }
      };

    }());

    document.addEventListener('DOMContentLoaded', function() {
      document.querySelector('#find').addEventListener('click', function () {
        primesApp.findFirstPrimes();
      });
    });

  </script>
</body>
</html>
